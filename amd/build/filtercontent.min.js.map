{"version":3,"file":"filtercontent.min.js","sources":["../src/filtercontent.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Script filterContent.js\n *\n * This script sets up the logic to be executed on opening the tinyMCE editor.\n *\n * @module      tiny_edusharing/filtercontent\n * @copyright   2024 metaVentis GmbH <http://metaventis.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport const setup = async(editor) => {\n    // Register the edu-sharing Formatter for use in all buttons.\n    editor.on('PreInit', () => {\n        editor.formatter.register('edusharing', {\n            inline: 'div',\n            classes: 'edusharing-placeholder',\n        });\n    });\n\n    editor.on('SetContent', () => {\n        // Listen to the SetContent event on the editor and update any edu-sharing-placeholder to not be editable.\n        // Doing this means that the inner content of the placeholder cannot be changed without using the dialogue.\n        // The SetContent event is called whenever content is changed by actions such as initial load, paste, undo, etc.\n        editor.getBody().querySelectorAll('.edusharing-placeholder:not([contenteditable])').forEach((node) => {\n            node.contentEditable = false;\n        });\n        // Old atto preview links need to be redirected in case the atto plugin is not installed.\n        editor.getBody().querySelectorAll('img.edusharing_atto').forEach(node => {\n            node.src = node.src.replace('/lib/editor/atto/plugins/edusharing/', '/mod/edusharing/');\n        });\n    });\n};\n"],"names":["async","editor","on","formatter","register","inline","classes","getBody","querySelectorAll","forEach","node","contentEditable","src","replace"],"mappings":"oKAyBqBA,MAAAA,SAEjBC,OAAOC,GAAG,WAAW,KACjBD,OAAOE,UAAUC,SAAS,aAAc,CACpCC,OAAQ,MACRC,QAAS,8BAIjBL,OAAOC,GAAG,cAAc,KAIpBD,OAAOM,UAAUC,iBAAiB,kDAAkDC,SAASC,OACzFA,KAAKC,iBAAkB,KAG3BV,OAAOM,UAAUC,iBAAiB,uBAAuBC,SAAQC,OAC7DA,KAAKE,IAAMF,KAAKE,IAAIC,QAAQ,uCAAwC"}